<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link rel="stylesheet" href="http://apps.bdimg.com/libs/bootstrap/3.3.0/css/bootstrap.min.css">
    <script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>

    <style>
        .greyer {
            -webkit-filter: grayscale(10);/* Webkit */
            filter: grayscale(10);/* W3C */
            }
        .shadow{
            -webkit-box-shadow: 0 1px 5px 0 rgba(0,34,77,.12);
            -moz-box-shadow: 0 1px 5px 0 rgba(0,34,77,.12);
            box-shadow: 0 1px 5px 0 rgba(0,34,77,.12);
        }
        .shadow-smaller{
            -webkit-box-shadow: 0 1px 5px 0 rgba(0,34,77,.07);
            -moz-box-shadow: 0 1px 5px 0 rgba(0,34,77,.07);
            box-shadow: 0 1px 5px 0 rgba(0,34,77,.07);
        }

    </style>
</head>
<body style="background-color: #fafafa">

<div class="container-fluid">
    <div class="col-md-12 column" style="position: fixed;top: 0;z-index: 999">
        <div class="row clearfix">
            <div class="col-md-2 column">
            </div>
            <div class="col-md-8 column" style="">
                <div class="row clearfix">
                    <ul class="nav nav-pills shadow" style="background-color: #ffffff;margin-right: -3px;margin-left: 5px">
                        <li class="active">
                            <a href="http://127.0.0.1:3000/home" style="padding: 0 10px 0 10px;font-size: 28px">知</a>
                        </li>
                        <li>
                            <a href="http://127.0.0.1:3000/home">首页</a>
                        </li>
                        <li class="disabled">
                            <a href="#">发现</a>
                        </li>
                        <li>
                            <a class="text-muted" href="http://127.0.0.1:3000/topicSquare">话题</a>
                        </li>
                        <li style="margin-left: 60px;margin-top: 3px">
                            <div class="input-group" style="width:342px">
                            <input type="text" class="form-control">
                            <span class="input-group-addon" style="background-color: #6db0ff;color:white;">搜索</span>
                        </div>
            </li>
                        <li class="dropdown pull-right" style="margin-top: 7px;margin-right: 8px">
                            <span class="text-muted" style="margin-right: 18px;">消息</span>
                            <img data-toggle="dropdown" src="http://127.0.0.1:3000/static/userhead/{{uid}}.jpg" style="width:28px">
                            <ul class="dropdown-menu">
                                <li>
                                    <a href="http://127.0.0.1:3000/page/1/answer">个人主页</a>
                                </li>
                                <li class="divider">
                                </li>
                                <li>
                                    <a href="http://127.0.0.1:3000/logout">退出登录</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="col-md-2 column">
            </div>
        </div>
    </div>

    <div class="col-md-12 column" style="margin-top: 50px">
        <div class="row clearfix">
            <div class="col-md-2 column">
            </div>
            <div class="col-md-5 column" style="padding:0;margin: 2px">
                <div class="shadow-smaller" style="background-color: white;margin-left: 10px;margin-right:-10px;padding:15px;border:1px #fafafa;border-top-right-radius:4px; border-top-left-radius:4px; border-bottom-left-radius:4px; border-bottom-right-radius:4px; ">
                        <img src="http://127.0.0.1:3000/static/topichead/{{thistopic.id}}.jpg" style="width: 100px">
                        <span id="test" style="font-size: 30px;"><strong>{{thistopic.topic}}</strong></span>
                        <br/>
                        <span>{{thistopic.topicIntro}}</span>
                    </div>

                <div class="shadow-smaller" style="margin-top: 0;border: #fafafa solid 1px;background-color: white;margin-left: 10px;;margin-bottom: 10px;margin-right:-10px;padding:15px;">
                        <span style="border: #f3f3f3 solid 1px;background-color: #8590A6;padding:8px 18px 8px 18px;border-top-right-radius:5px; border-top-left-radius:5px; border-bottom-left-radius:5px; border-bottom-right-radius:5px; ">取消关注</span>
                        &nbsp&nbsp&nbsp
                    <span id="share" style="color: deepskyblue">分享</span>
                </div>
                <div class="shadow-smaller" style="background-color: white;margin-left: 10px;margin-right:-10px;padding:15px;border:1px #fafafa;border-top-right-radius:4px; border-top-left-radius:4px; border-bottom-left-radius:4px; border-bottom-right-radius:4px; ">
                    <span style="font-size: 16px;font-weight: bold">讨论</span>
                    <span style="font-size: 16px;margin-left: 40px">等待回答</span>
                    <span class="pull-right text-muted"><=>切换为按时间排序</span>
                    </div>
                {%for key in answered%}
                <div class="shadow-smaller" style="background-color: white;margin-left: 10px;margin-right:-10px;padding:15px;border:1px #fafafa;border-top-right-radius:4px; border-top-left-radius:4px; border-bottom-left-radius:4px; border-bottom-right-radius:4px; ">
                   <span style="font-weight: bold;font-size: 20px">{{key.queTitle}}</span>
                    <br/>
                    <img src="http://127.0.0.1:3000/static/userhead/{{key.uid}}.jpg" style="width: 25px">
                    <span style="font-size: 18px;font-family: 'Helvetica Neue';">{{key.account}}</span>
                    <span class="text-muted">,{{key.shortIntro}}</span>
                    <p class="text-muted" style="font-size: 14px">{{key.like}}人赞同了该答案</p>
                    <p style="font-size: 15px;line-height: 24px">{{key.content}}</p>
                    <p class="text-muted" style="font-size: 14px">发布于{{key.time}}</p>
                    <div>
                        <span class="text-info" style="background-color:#e5f2ff;padding:6px 12px 6px 12px;border: #31708f 1px;border-top-right-radius:4px; border-top-left-radius:4px; border-bottom-left-radius:4px; border-bottom-right-radius:4px;">▲132</span>
                        <span class="text-info" style="background-color:#e5f2ff;padding:6px 12px 6px 12px;border: #31708f 1px;border-top-right-radius:4px; border-top-left-radius:4px; border-bottom-left-radius:4px; border-bottom-right-radius:4px;">▼</span>
                        <span id="comment{{key.id}}" class="text-muted commentclick" name="{{key.id}}" style="margin-left: 20px;">{{key.comCount}}条评论</span>
                        <span class="text-muted" style="margin-left: 20px;">分享</span>
                        <span class="text-muted" style="margin-left: 20px;">收藏</span>
                        <span class="text-muted" style="margin-left: 20px;">•••</span>
                    </div>
                    <hr id="line{{key.id}}" style="display:none;margin-top: 15px;margin-bottom: 15px"/>
                    <div style="display: none" name="0">

                    </div>
                </div>

                {%endfor%}
                <ul class="pagination" style="margin-left: 30px;margin-right: 30px">
                    <li>
                        <a href="#">Prev</a>
                    </li>
                    <li>
                        <a href="#">1</a>
                    </li>
                    <li>
                        <a href="#">2</a>
                    </li>
                    <li>
                        <a href="#">3</a>
                    </li>
                    <li>
                        <a href="#">4</a>
                    </li>
                    <li>
                        <a href="#">5</a>
                    </li>
                    <li>
                        <a href="#">Next</a>
                    </li>
                </ul>
            </div>
            <div class="col-md-3 column" style="position: fixed;right:16%">
                <ul>
                    <li>
                        Lorem ipsum dolor sit amet
                    </li>
                    <li>
                        Consectetur adipiscing elit
                    </li>
                    <li>
                        Integer molestie lorem at massa
                    </li>
                    <li>
                        Facilisis in pretium nisl aliquet
                    </li>
                    <li>
                        Nulla volutpat aliquam velit
                    </li>
                    <li>
                        Faucibus porta lacus fringilla vel
                    </li>
                    <li>
                        Aenean sit amet erat nunc
                    </li>
                    <li>
                        Eget porttitor lorem
                    </li>
                </ul>
            </div>
            <div class="col-md-2 column">
            </div>
        </div>
        <hr style="margin: 20px;">
        <div class="row clearfix">
            <div class="col-md-2 column">
            </div>
            <div class="col-md-5 column">
                <address> <strong>hit.</strong><br /> 795 Folsom Ave, Suite 600<br /> San Francisco, CA 94107<br /> <abbr title="Phone">P:</abbr> (123) 456-7890</address>
            </div>
            <div class="col-md-3 column">
            </div>
            <div class="col-md-2 column">
            </div>
        </div>
    </div>
</div>
</div>
<script type="text/javascript">
    function ParentTree() {this.nodes = [];}function ParentTreeNode(data, parent) {this.data = data || null;this.parent = parent || 0;}

    $(document).ready(function () {
        $(".commentclick").on("click",function () {
            var kingdom=$(this).parent().next().next();
            var pt = new ParentTree();
            if(kingdom.css("display")=="none"&&kingdom.attr("name")=="0"){
                kingdom.attr("name","1")
                kingdom.css("display","")
                $.ajax({
                url:'http://127.0.0.1:3000/comment/answer',
                type:'GET',
                contentType: 'application/json; charset=UTF-8',
                dataType:'json',
                success:function (data) {
                    if(data.msg=='1'){
                        
                        newdata=data.data;
                        //console.log(newdata)
                        for(var key in newdata){
                            for(var king in newdata){
                                if(newdata[key].pid==-1){
                                    pt.nodes.push(new ParentTreeNode(newdata[key], -1));
                                    break;
                                }
                                else if(newdata[king].id==newdata[key].pid){
                                    pt.nodes.push(new ParentTreeNode(newdata[key], king));
                                    break;
                                }
                            }
                        }
                    }
                    maxDepth=0;
                    console.log(pt.nodes[1].data)
                    for(var i=0;i<pt.nodes.length;i++){
                        depth=0;
                        for (var j=i; j!=-1;j=pt.nodes[j].parent){
                            depth=depth+1;
                        }
                        if(depth>maxDepth)maxDepth=depth
                    }
                    for(var i in pt.nodes){
                        if(pt.nodes[i].parent==-1){
                            kingdom.append("<div name=\""+i+"\" style=\"background-color: #fafafa;margin-top: 10px;border:1px solid #eeeeee;padding: 7px;border-top-right-radius:8px; border-top-left-radius:8px; border-bottom-left-radius:8px; border-bottom-right-radius:8px;\">\n" +
                "        <div>\n" +
                "            <img src=\"http://127.0.0.1:3000/static/userhead/"+pt.nodes[i].data.uid+".jpg\" style=\"width: 15px\">\n" +
                "            <span>"+pt.nodes[i].data.account+":</span>\n" +
                "            <span>"+pt.nodes[i].data.content+"</span>\n" +
                "            <img class='likeanscomment' src=\"http://127.0.0.1:3000/static/material/like.jpg\" width=\"13px\" style='margin-left: 5px'>\n" +
                "            <span class='text-muted' style='font-size: 12px;'>"+pt.nodes[i].data.like+"</span>\n" +
                "            <img class='unlikeanscomment' src=\"http://127.0.0.1:3000/static/material/unlike.jpg\" width=\"13px\" style='margin-left: 5px'>\n" +
                "            <img class='replyanscomme' src=\"http://127.0.0.1:3000/static/material/reply.jpg\" width=\"13px\" style='margin-left: 5px'>\n" +
                "            <img class='tipoffanscomment' src=\"http://127.0.0.1:3000/static/material/tipoff.png\" width=\"13px\" style='margin-left: 5px'>\n" +
                "            <span class=\"pull-right\">"+pt.nodes[i].data.time+"</span>" +
                "        </div>\n" +
                "    </div>")
                            pt.nodes[i].parent=-2
                        }
                    }
                    for (var i=0;i<maxDepth+3;i++){
                        for (var p=0;p<pt.nodes.length;p++){
                            kingdom.find("div[name='"+pt.nodes[p].parent+"']").append("<div name=\""+p+"\" style=\"background-color: #fafafa;margin-top: 10px;border:1px solid #eeeeee;padding: 7px;border-top-right-radius:8px; border-top-left-radius:8px; border-bottom-left-radius:8px; border-bottom-right-radius:8px;\">\n" +
                "        <div>\n" +
                "            <img src=\"http://127.0.0.1:3000/static/userhead/"+pt.nodes[p].data.uid+".jpg\" style=\"width: 15px\" style='margin-left: 5px'>\n" +
                "            <span>"+pt.nodes[p].data.account+":</span>\n" +
                "            <span>"+pt.nodes[p].data.content+"</span>\n" +
                "            <img class='likeanscomment' src=\"http://127.0.0.1:3000/static/material/like.jpg\" onmouseover='if($(this).attr(\"width\")==\"13px\"){$(this).attr(\"width\",\"14px\")}else{$(this).attr(\"width\",\"13px\")}' width=\"13px\" style='margin-left: 5px'>\n" +
                "            <span class='text-muted' style='font-size: 12px;'>"+pt.nodes[p].data.like+"</span>\n" +
                "            <img class='unlikeanscomment' src=\"http://127.0.0.1:3000/static/material/unlike.jpg\" width=\"13px\" style='margin-left: 5px'>\n" +
                "            <img class='replyanscomment' src=\"http://127.0.0.1:3000/static/material/reply.jpg\" width=\"13px\" style='margin-left: 5px'>\n" +
                "            <img class='tipoffanscomment' src=\"http://127.0.0.1:3000/static/material/tipoff.png\" width=\"13px\" style='margin-left: 5px'>\n" +
                "            <span class=\"pull-right\">"+pt.nodes[p].data.time+"</span>" +
                "        </div>\n" +
                "    </div>")
                            pt.nodes[p].parent=-2
                        }
                    }
                },
                error:function (e) {alert(e.status)}
            })
            }
            else if(kingdom.css("display")=="none"&&kingdom.attr("name")=="1"){
                kingdom.css("display","");
            }
            else{
                kingdom.css("display","none");
            }
        })

        $('#share').click(function () {
            alert("111111")
            var v="ppp"
            window.clipboardData.setData("text",v);
        })
 })

    </script>
<script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>

</body>
</html>

